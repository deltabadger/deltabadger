<% content_for :title, @page_title %>
<% content_for :meta_description, @meta_description %>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Lexend:wght@100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">

<% if @article.thumbnail_path.present? %>
  <div class="article-bg-top">
    <%= image_tag @article.thumbnail_path, alt: @article.title, class: "article-bg-top__image" %>
  </div>
<% end %>


<article class="article">
  <header class="article__header">
    <hgroup>
    <h1 class="article__header__title"><%= @article.title %></h1>
    <% if @article.subtitle.present? %>
      <div class="article__header__subtitle"><%= @article.subtitle %></div>
    <% end %>
    </hgroup>
    <div class="article__header__meta">
      <% if @article.author.present? %>
        <% if @article.author.url.present? %>
          <a href="<%= @article.author.url %>" class="article__header__meta__author" target="_blank" rel="noopener"><%= @article.author.name %></a>
        <% else %>
          <span class="article__header__meta__author"><%= @article.author.name %></span>
        <% end %>
      <% end %>
      <% if @article.published_at.present? %>
        &middot;
        <time class="article__header__meta__date" datetime="<%= @article.published_at.iso8601 %>">
          <%= l(@article.published_at.to_date, format: :long) %>
        </time>
      <% end %>
      
      <% if @article.reading_time_minutes.present? %>
        &middot;
        <span class="article__header__meta__reading-time">
          <%= t('articles.reading_time', minutes: @article.reading_time_minutes) %>
        </span>
      <% end %>
      
      <% if @article.has_paywall? %>
        &middot;
        <span class="article__header__meta__premium">
          <%= t('articles.premium_content') %>
        </span>
      <% end %>
      
    </div>
  </header>

  <div class="article-body">
    <%= raw @content %>
  </div>
  
  <% if @has_paywall && !@user_has_access %>
    <div class="paywall">
      <h3><%= t('articles.paywall.title') %></h3>
      <p><%= t('articles.paywall.description') %></p>
      <div class="paywall__actions">
        <% if user_signed_in? %>
          <%= link_to t('articles.paywall.upgrade_button'), upgrade_path, class: "button button--primary button--large" %>
        <% else %>
          <%= button_to omniauth_authorize_path(:user, :google_oauth2), method: :post, data: { turbo: false }, class: "button button--google button--large" do %>
            <%= render "svg/google" %>
            <%= t('shared.links.signup_with_google') %>
          <% end %>
          <%# link_to t('links.log_in'), new_user_session_path, class: "button button--link button--large" %>
        <% end %>
      </div>
    </div>
  <% end %>

</article>