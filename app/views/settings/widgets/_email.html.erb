<div class="widget">
  <h4 class="modal__title"><%= t('settings.index.email_section') %></h4>
  <%= turbo_frame_tag "update_email_form" do %>
    <%= form_with model: current_user, url: settings_update_email_path, class: "setting-form", data: { controller: "form--html5-validations form--label-animations", turbo_frame: "update_email_form" } do |f| %>

      <% if current_user.pending_reconfirmation? %>
        <div class="form__row form__row--input" style="text-align: center;">
          <%= t('devise.registrations.edit.awaiting_confirmation', email: current_user.unconfirmed_email) %>
        </div>
      <% end %>

      <div class="form__row form__row--input">
        <%= f.email_field :email, autocomplete: "username", class: 'form__input', value: "", placeholder: current_user.email, pattern: email_address_pattern, data: { html5_error_message: t('devise.registrations.new.email_invalid') } %>
        <%= f.label :email, t('helpers.label.user.new_email'), class: "form__label" %>
      </div>

      <%= tag.div class: "form__row db-has-unmask", data: { controller: "form--password-unmask" } do %>
        <%= f.password_field :current_password, autocomplete: "current-password", class: "form__input form__input--has-icon", data: { form__password_unmask_target: "input" } %>
        <%= f.label :current_password, t('helpers.label.user.current_password'), class: "form__label" %>
        <div class="db-unmask" data-action="click->form--password-unmask#toggle">
          <%= render "layouts/svg_mi_visibility" %>
          <%= render "layouts/svg_mi_visibility-off" %>
        </div>
      <% end %>

      <%= f.submit t('button.update'), class: "button button--primary" %>
    <% end %>
  <% end %>
</div>
