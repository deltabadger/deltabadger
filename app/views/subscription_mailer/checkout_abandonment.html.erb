<h1><%= t('.subject') %></h1>

<p><%= t('mailer.greeting_name', name: @user.name) %></p>

<%= t('.template_html', plan_name: localized_plan_name(@subscription_plan.name)) %>

<div style="background-color: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
  <h3><%= t('.missing_features_title') %></h3>
  
  <ul>
    <% 
      plan_name = @subscription_plan.name.downcase
      features = []
      
      # Base features for trading plans
      unless plan_name == 'research'
        features += [:dca_bots, :fee_cutter, :smart_intervals]
      end
      
      # Advanced trading features  
      if ['standard', 'pro'].include?(plan_name.gsub('+research', ''))
        features += [:triggers]
      end
      
      # Research features
      if plan_name.include?('research') || plan_name == 'pro'
        features += [:newsletter, :analyzer]
      end
      
      features.each do |feature|
    %>
      <li><%= t(".features.#{feature}") %></li>
    <% end %>
  </ul>
</div>

<p><%= t('.limited_time_offer') %></p>

<p>
  <%= link_to t('.complete_upgrade'), upgrade_url(locale: I18n.locale), 
             style: "background-color: #dc3545; color: white; padding: 15px 30px; text-decoration: none; border-radius: 4px; display: inline-block; font-weight: bold; font-size: 16px;" %>
</p>

<p style="color: #666; font-size: 14px;"><%= t('.no_payment_taken') %></p> 