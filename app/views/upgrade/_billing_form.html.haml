- if upgrade_presenter.upgrade_available?
  .modal-dialog.m-0(style="max-width: 100%")
    .modal-content
      .modal-body
        %ul#payTab.nav.nav-tabs{:role => "tablist"}
          %li.nav-item
            %a#stats-tab.nav-link{"aria-controls" => "payBitcoin", "aria-selected" => "true", "data-toggle" => "tab", :href => "#payBitcoin", :role => "tab", :class => ('active' unless after_wire_transfer)}
              .db-card-providers
                %img.db-card-providers__item.db-card-providers__item--bitcoin{:src => asset_pack_path("media/images/bitcoin.svg")}
              //t('subscriptions.payment.bitcoin')
          %li.nav-item
            %a#log-tab.nav-link{"aria-controls" => "payWire", "aria-selected" => "true", "data-toggle" => "tab", :href => "#payWire", :role => "tab", :class => ('active' if after_wire_transfer)}= t('subscriptions.payment.wire_transfer')
        #payTabContent.tab-content
          #payBitcoin.tab-pane.show{"aria-labelledby" => "stats-tab", :role => "tabpanel", :class => ('active' unless after_wire_transfer)}
            %h5.mb-4= t('subscriptions.payment.billing_information')
            = form_for payment, url: upgrade_pay_path do |f|
              - if errors.present?
                %ul.pl-3
                  - errors.each do |error|
                    %li.text-danger= error

              - if 'investor'.in?(upgrade_presenter.available_plans)
                - investor_selected = upgrade_presenter.selected_plan_name == 'investor'
                %input.db-plan-radio{type: 'radio', id: 'payment_plan_investor', name: 'payment[subscription_plan_id]', value: upgrade_presenter.investor_plan.id, checked: investor_selected}
              - if 'hodler'.in?(upgrade_presenter.available_plans)
                - hodler_selected = upgrade_presenter.selected_plan_name == 'hodler'
                %input.db-plan-radio{type: 'radio', id: 'payment_plan_hodler', name: 'payment[subscription_plan_id]', value: upgrade_presenter.hodler_plan.id, checked: hodler_selected}

              .db-form__row
                = f.text_field :first_name, class: 'db-form__input', value: "", autocomplete: "given-name", onchange: 'this.setAttribute("value", this.value);'
                = f.label :first_name, class: 'db-form__label'

              .db-form__row
                = f.text_field :last_name, class: 'db-form__input', value: "", autocomplete: "family-name", onchange: 'this.setAttribute("value", this.value);'
                = f.label :last_name, class: 'db-form__label'

              .db-form__row
                = f.date_field :birth_date, value: "", autocomplete: "bday", class: 'db-form__input db-form__input--date', onchange: 'this.setAttribute("value", this.value);'
                = f.label :birth_date, class: 'db-form__label'

              .db-form__row
                = f.select :country, nil, {}, value: "", autocomplete: "country-name", class: 'db-form__input db-form__input--select', onchange: 'this.setAttribute("value", this.value);', onfocus: 'this.setAttribute("value", this.value);' do
                  - cost_presenters.each do |country, presenter|
                    - selected = country == payment.country
                    - translated_name = country
                    - if translated_name == 'Other'
                      - translated_name = t('helpers.label.payment.other')
                    = content_tag :option, translated_name, value: country, selected: selected, data: { ibp: presenter[:investor].base_price, hbp: presenter[:hodler].base_price, ifd: presenter[:investor].flat_discount, hfd: presenter[:hodler].flat_discount, idp:presenter[:investor].flat_discounted_price, hdp:presenter[:hodler].flat_discounted_price, idpa: presenter[:investor].discount_percent_amount, hdpa: presenter[:hodler].discount_percent_amount, vp: presenter[:investor].vat_integer, itv: presenter[:investor].total_vat, htv: presenter[:hodler].total_vat, itp: presenter[:investor].total_price, htp: presenter[:hodler].total_price }
                = f.label :country, class: 'db-form__label'

              .db-form__row.db-form__row--final-button
                %button.btn.btn-success.btn-lg.w-100.px-1{type: 'submit'}
                  %span.mr-0= t('subscriptions.payment.pay_with_bitcoin')
                  %svg.ml-1{class: 'db-bot__svg-icon db-svg-icon db-svg-icon--arrow-forward', xmlns: 'http://www.w3.org/2000/svg', width: '24', viewBox: '0 0 24 24'}
                    %path{d: 'M5 13h11.2l-5 4.9a1 1 0 000 1.4c.5.4 1.1.4 1.5 0l6.6-6.6c.4-.4.4-1 0-1.4l-6.6-6.6a1 1 0 10-1.4 1.4l4.9 4.9H5c-.6 0-1 .5-1 1s.5 1 1 1z'}

          #payWire.tab-pane.show{"aria-labelledby" => "stats-tab", :role => "tabpanel", :class => ('active' if after_wire_transfer)}
            - if after_wire_transfer
              = t('subscriptions.payment.after_wire_transfer_html')
            - else
              %h5.mb-4= t('subscriptions.payment.billing_information')
              = form_for payment, url: upgrade_pay_wire_transfer_path do |f|
                - if errors.present?
                  %ul.pl-3
                    - errors.each do |error|
                      %li.text-danger= error

                - if 'investor'.in?(upgrade_presenter.available_plans)
                  - investor_selected = upgrade_presenter.selected_plan_name == 'investor'
                  %input.db-plan-radio{type: 'radio', id: 'payment_plan_investor', name: 'payment[subscription_plan_id]', value: upgrade_presenter.investor_plan.id, checked: investor_selected}
                - if 'hodler'.in?(upgrade_presenter.available_plans)
                  - hodler_selected = upgrade_presenter.selected_plan_name == 'hodler'
                  %input.db-plan-radio{type: 'radio', id: 'payment_plan_hodler', name: 'payment[subscription_plan_id]', value: upgrade_presenter.hodler_plan.id, checked: hodler_selected}

                .db-form__row
                  = f.text_field :first_name, id: 'wire_payment_first_name', class: 'db-form__input', value: "", autocomplete: "given-name", onchange: 'this.setAttribute("value", this.value);'
                  = f.label :first_name, class: 'db-form__label'

                .db-form__row
                  = f.text_field :last_name, id: 'wire_payment_last_name', class: 'db-form__input', value: "", autocomplete: "family-name", onchange: 'this.setAttribute("value", this.value);'
                  = f.label :last_name, class: 'db-form__label'

                .db-form__row
                  = f.text_field :address, id: 'wire_payment_address', class: 'db-form__input', value: "", autocomplete: "street-address", onchange: 'this.setAttribute("value", this.value);'
                  = f.label :street_address, class: 'db-form__label'

                .db-form__row.db-form__row--double
                  .db-form__row__col
                    = f.text_field :address, id: 'wire_payment_address', class: 'db-form__input', value: "", autocomplete: "postal-code", onchange: 'this.setAttribute("value", this.value);'
                    = f.label :street_address, "Postal code", class: 'db-form__label'
                  .db-form__row__col
                    = f.text_field :address, id: 'wire_payment_address', class: 'db-form__input', value: "", autocomplete: "address-level2", onchange: 'this.setAttribute("value", this.value);'
                    = f.label :city, class: 'db-form__label'

                .db-form__row
                  = f.select :country, nil, {}, value: "", autocomplete: "country-name", id: 'wire_payment_country', class: 'db-form__input db-form__input--select', onchange: 'this.setAttribute("value", this.value);', onfocus: 'this.setAttribute("value", this.value);' do
                    - cost_presenters.each do |country, presenter|
                      - selected = country == payment.country
                      - translated_name = country
                      - if translated_name == 'Other'
                        - translated_name = t('helpers.label.payment.other')
                      = content_tag :option, translated_name, value: country, selected: selected, data: { ibp: presenter[:investor].base_price, hbp: presenter[:hodler].base_price, ifd: presenter[:investor].flat_discount, hfd: presenter[:hodler].flat_discount, idp:presenter[:investor].flat_discounted_price, hdp:presenter[:hodler].flat_discounted_price, idpa: presenter[:investor].discount_percent_amount, hdpa: presenter[:hodler].discount_percent_amount, vp: presenter[:investor].vat_integer, itv: presenter[:investor].total_vat, htv: presenter[:hodler].total_vat, itp: presenter[:investor].total_price, htp: presenter[:hodler].total_price }
                  = f.label :country, class: 'db-form__label'

                .db-form__row
                  = f.text_area :address, id: 'wire_payment_address', class: 'db-form__input', value: "", onchange: 'this.setAttribute("value", this.value);'
                  = f.label :comment, "Add comment (optional)", class: 'db-form__label'

                .form-group
                  %input#company{ :name => "company", :type => "checkbox", :value => "company"}
                  %label.form-check-label{:for => "company"} I need business invoice.


                .db-form__row{ class: "db-form-group--eu-company__visible" }
                  = f.text_field :vat_number, pattern: '^(ATU[0-9]{8}|BE0[0-9]{9}|BG[0-9]{9,10}|CY[0-9]{8}L|CZ[0-9]{8,10}|DE[0-9]{9}|DK[0-9]{8}|EE[0-9]{9}|(EL|GR)[0-9]{9}|ES[0-9A-Z][0-9]{7}[0-9A-Z]|FI[0-9]{8}|FR[0-9A-Z]{2}[0-9]{9}|GB([0-9]{9}([0-9]{3})?|[A-Z]{2}[0-9]{3})|HU[0-9]{8}|IE[0-9]S[0-9]{5}L|IT[0-9]{11}|LT([0-9]{9}|[0-9]{12})|LU[0-9]{8}|LV[0-9]{11}|MT[0-9]{8}|NL[0-9]{9}B[0-9]{2}|PL[0-9]{10}|PT[0-9]{9}|RO[0-9]{2,10}|SE[0-9]{12}|SI[0-9]{8}|SK[0-9]{10})$', type: 'text', autocomplete: 'nope', value: "", class: "db-form__input", onchange: 'this.setAttribute("value", this.value);'
                  .db-form__info.db-form__info--invalid
                    =t('subscriptions.payment.invalid_vat_number')
                  = f.label :vat_number, "VAT number (optional)", class: "db-form__label"
                .db-form__row
                  = f.text_field :address, id: 'wire_payment_address', class: 'db-form__input', value: "", autocomplete: 'organization', onchange: 'this.setAttribute("value", this.value);'
                  = f.label :company, "Company name (optional)", class: 'db-form__label'



                .db-form__row.db-form__row--final-button
                  %button.btn.btn-success.btn-lg.w-100.px-1{type: 'submit'}
                    Order Investor plan
                    //%span.mr-0= t('bots.setup.next')
