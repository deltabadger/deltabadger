<%= form_with model: bot,
              url: bot.new_record? ? barbell_new_step_confirm_bots_path : bot_path(bot),
              method: bot.new_record? ? :get : :patch,
              id: "settings-marketcap-allocation",
              class: "widget",
              data: { controller: "form--submit" } do |f| %>
  <% if bot.new_record? %>
    <%= f.hidden_field :label, value: bot.label %>
    <%= f.hidden_field :base0_asset_id, value: bot.base0_asset_id %>
    <%= f.hidden_field :base1_asset_id, value: bot.base1_asset_id %>
    <%= f.hidden_field :quote_asset_id, value: bot.quote_asset_id %>
    <%= f.hidden_field :exchange_id, value: bot.exchange_id %>
    <%= f.hidden_field :quote_amount, value: bot.quote_amount %>
    <%= f.hidden_field :interval, value: bot.interval %>
    <%= f.hidden_field :allocation0, value: bot.allocation0 %>
    <%= f.hidden_field :quote_amount_limited, value: bot.quote_amount_limited %>
    <%= f.hidden_field :quote_amount_limit, value: bot.quote_amount_limit %>
  <% end %>
  <div class="toggle-group" data-controller="class-toggle" data-class-toggle-toggle-classes-value='["hidden"]'>

    <div class="toggle">
      <%= f.check_box :marketcap_allocated, data: { action: "change->form--submit#submit" }, disabled: bot.working? %>
      <div class="toggle__style"></div>
      <%= f.label :marketcap_allocated, t('bot.utils.mkt_cap_adjusted'), class: "label" %>

      <div class="tooltip-info-icon" data-controller="tooltip" data-action="click->tooltip#toggle click->class-toggle#toggle">
        <div class="tooltip-icon--off">
          <%= render 'svg/24x24_info' %>
        </div>
        <div class="tooltip-icon--on">
          <%= render 'svg/24x24_info-filled' %>
        </div>
      </div>
    </div>

    <div class="hidden" data-class-toggle-target="togglable">
      <%= t('bot.utils.mkt_cap_adjusted_info_html').html_safe %>
    </div>
  </div>
<% end %>
