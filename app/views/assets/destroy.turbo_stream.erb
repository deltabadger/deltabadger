<% @portfolio.reload %>
<% @portfolio.assets.each do |asset| %>
  <%= turbo_stream.replace asset, partial: "asset", locals: { asset: asset } %>
<% end %>
<%= turbo_stream.remove @asset %>
<%= turbo_stream.update "portfolio-empty", partial: "portfolios/empty", locals: { portfolio: @asset.portfolio } %>
<%= turbo_stream.update "smart-allocation-controls", partial: "portfolios/smart_allocation_controls", locals: { portfolio: @asset.portfolio } %>
<%= turbo_stream.update "normalize", partial: "portfolios/normalize", locals: { portfolio: @asset.portfolio } %>
<% if @portfolio.allocations_are_normalized? %>
  <%= turbo_stream.replace "backtest-results", partial: "portfolios/backtest_results", locals: { backtest: @backtest } %>
<% end %>